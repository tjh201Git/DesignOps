function Phi_q = buildPhi_q(Xq,order,x1qn,x2qn,x3qn)

switch order

    case 1
Phi1order_q = [ ...
    ones(size(Xq,1),1), ...
    x1qn, x2qn, x3qn ];
    Phi_q = Phi1order_q;
    return;

    case 2
Phi2order_q = [ ...        
    ones(size(Xq,1),1), ...
    x1qn, x2qn, x3qn, ...
    x1qn.^2, x2qn.^2, x3qn.^2, ...
    x1qn.*x2qn, x1qn.*x3qn, x2qn.*x3qn ];   
    Phi_q = Phi2order_q;
    return;

    case 3
Phi3order_q = [ ...
    ones(size(Xq,1),1), ...
    x1qn, x2qn, x3qn, ...
    x1qn.^2, x2qn.^2, x3qn.^2, ...
    x1qn.*x2qn, x1qn.*x3qn, x2qn.*x3qn, ...
    x1qn.^3, x2qn.^3, x3qn.^3, ...
    x1qn.^2.*x2qn, x1qn.^2.*x3qn, ...
    x2qn.^2.*x1qn, x2qn.^2.*x3qn, ...
    x3qn.^2.*x1qn, x3qn.^2.*x2qn, ...
    x1qn.*x2qn.*x3qn ];
    Phi_q = Phi3order_q;
    return;

    case 4
Phi4order_q = [ ...
    ones(size(Xq,1),1), ...
    x1qn, x2qn, x3qn, ...
    x1qn.^2, x2qn.^2, x3qn.^2, ...
    x1qn.*x2qn, x1qn.*x3qn, x2qn.*x3qn, ...
    x1qn.^3, x2qn.^3, x3qn.^3, ...
    x1qn.^2.*x2qn, x1qn.^2.*x3qn, ...
    x2qn.^2.*x1qn, x2qn.^2.*x3qn, ...
    x3qn.^2.*x1qn, x3qn.^2.*x2qn, ...
    x1qn.*x2qn.*x3qn, ...
    x1qn.^4, x2qn.^4, x3qn.^4, ...
    x1qn.^3.*x2qn, x1qn.^3.*x3qn, ...
    x2qn.^3.*x1qn, x2qn.^3.*x3qn, ...
    x3qn.^3.*x1qn, x3qn.^3.*x2qn, ...
    x1qn.^2.*x2qn.^2, x1qn.^2.*x3qn.^2, x2qn.^2.*x3qn.^2, ...
    x1qn.^2.*x2qn.*x3qn, x2qn.^2.*x1qn.*x3qn, x3qn.^2.*x1qn.*x2qn ];
    Phi_q = Phi4order_q;
    return;

    case 5
Phi5order_q = [ones(size(Xq,1),1), ...
    x1qn, x2qn, x3qn, ...
    x1qn.^2, x2qn.^2, x3qn.^2, ...
    x1qn.*x2qn, x1qn.*x3qn, x2qn.*x3qn, ...
    x1qn.^3, x2qn.^3, x3qn.^3, ...
    x1qn.^2.*x2qn, x1qn.^2.*x3qn, ...
    x2qn.^2.*x1qn, x2qn.^2.*x3qn, ...
    x3qn.^2.*x1qn, x3qn.^2.*x2qn, ...
    x1qn.*x2qn.*x3qn, ...
    x1qn.^4, x2qn.^4, x3qn.^4, ...
    x1qn.^3.*x2qn, x1qn.^3.*x3qn, ...
    x2qn.^3.*x1qn, x2qn.^3.*x3qn, ...
    x3qn.^3.*x1qn, x3qn.^3.*x2qn, ...
    x1qn.^2.*x2qn.^2, x1qn.^2.*x3qn.^2, x2qn.^2.*x3qn.^2, ...
    x1qn.^2.*x2qn.*x3qn, x2qn.^2.*x1qn.*x3qn, x3qn.^2.*x1qn.*x2qn, ...
    x1qn.^5, x2qn.^5, x3qn.^5, ...
    x1qn.^4.*x2qn, x1qn.^4.*x3qn, ...
    x2qn.^4.*x1qn, x2qn.^4.*x3qn, ...
    x3qn.^4.*x1qn, x3qn.^4.*x2qn, ...
    x1qn.^3.*x2qn.^2, x1qn.^3.*x3qn.^2, ...
    x2qn.^3.*x1qn.^2, x2qn.^3.*x3qn.^2, ...
    x3qn.^3.*x1qn.^2, x3qn.^3.*x2qn.^2, ...
    x1qn.^3.*x2qn.*x3qn, x2qn.^3.*x1qn.*x3qn, x3qn.^3.*x1qn.*x2qn, ...
    x1qn.^2.*x2qn.^2.*x3qn, x1qn.^2.*x3qn.^2.*x2qn, x2qn.^2.*x3qn.^2.*x1qn ];
    Phi_q = Phi5order_q;
    return;

end

end